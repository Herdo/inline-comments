!function(n,$,t){var i,o="incom_wrapper",e="#"+o,a="html",r="comments-and-form",c="#"+r,s="incom-commentform",u="data-incom",l=u+"-comment",f=[],d=u+"-bubble",m=u+"-ref",h="incom-active",p="."+h,v="incom-visible-comment",b="."+v,g="incom-position-",y="incom-bubble",w="."+y,k=y+"-style",C=y+"-static",S="."+C,T=y+"-dynamic",x=y+"-active",A=y+"-link",I="incom-comments-wrapper",O="."+I,D="incom-reply",W="."+D,j="incom-cancel",q="."+j,z="incom-info-icon",B="."+z,E="incom-scrolled-to",F=o+"-hidden",H=o+"-visible",N=F,_=c+" .comment",L="data_incom",Q=0,X=$(window).width(),Y,G,J;n.init=function(n){K(n),M(),P(),Ft(),jt(),$(W).find(".comment-reply-link").on("click",function(){$(c).find(" #commentform").attr("id",s)}),zt.init()};var K=function(n){i=$.extend({selectors:"p",moveSiteSelector:a,countStatic:!0,alwaysStatic:!1,defaultBubbleText:"+",bubbleStyle:"bubble",bubbleAnimationIn:"default",bubbleAnimationOut:"default",position:"left",background:"white",backgroundOpacity:"1",animation:!1},n)},M=function(){0===$(e).length&&$('<div id="'+o+'" class="'+N+" "+g+i.position+'"></div>').appendTo($(a))},P=function(){$(i.selectors).each(function(){var n=$(this);R(n),U.createFromElement(n)})},R=function(n,t){if(t=t||0,!n.attr(u)){var i=V(n);t=Z(t,i);var o=i+t;n.attr(u,o)}},U={set:function(n){var i=$.extend({posX:t,posY:t,id:t,visible:!1},n)},createFromElement:function(n){nt(n)}},V=function(n){var t=n.prop("tagName").substr(0,5);return t},Z=function(n,t){var i=t+n;if(-1!==$.inArray(i,f))for(;-1!==$.inArray(i,f);)n++,i=t+n;return f.push(i),n},nt=function(n){var t=tt(n),i=ot(n),o=$("<a/>",{href:"","class":A}).text(t).wrap(i).parent();rt(o),bt(n,o),yt(o)?(ct(n,o),st(n,o)):o.hide(),o.appendTo(e)},tt=function(n){var t;return t=at(n)?it(n):i.defaultBubbleText},it=function(n){var t=n.attr(u),i="["+l+"="+t+"]",o=$(c).find(i).length;return o+=$(c).find(i).find(".children").find("li").length},ot=function(n){var t=n.attr(u),i='<div class="'+et(n)+'" '+d+'="'+t+'" />';return i},et=function(n){var t=y,o=" ";return(i.alwaysStatic||at(n)&&i.countStatic)&&(t+=o+C),t+=at(n)||!at(n)&&"bubble"===i.bubbleStyle?o+k:o+T},at=function(n){var t=it(n);return $.isNumeric(t)&&t>0?!0:!1},rt=function(n){n.hasClass(C)&&n.css("display","block")},ct=function(n,t){t.hasClass(C)||n.add(t).hover(function(){$(e).find(w+":not("+S+")").hide(),"fadein"===i.bubbleAnimationIn?t.stop(!0,!0).fadeIn():t.stop(!0,!0).show(),yt(t)||t.hide()},function(){"fadeout"===i.bubbleAnimationOut?t.stop(!0,!0).fadeOut():t.stop(!0,!0).delay(700).hide(0)})},st=function(n,t){t.on("click",function(i){i.preventDefault(),$(this).hasClass(x)?(xt(!0),$(this).removeClass(x)):(Et(h),n.addClass(h),xt(),t.addClass(x),lt(t))})},ut=function(){var n;return n=0===$(O).length?$("<div/>",{"class":I}).css("background-color","rgba("+Nt(i.background)+","+i.backgroundOpacity+")").appendTo(e):$(O)},lt=function(n){var t=ut();ft("show"),pt(),mt(),bt(n,t),wt(t),St(),dt()},ft=function(n){var t=$(e);"show"===n?(t.removeClass(F),t.addClass(H)):"hide"===n&&(t.removeClass(H),t.addClass(F))},dt=function(){$(document).ready(Tt()).ajaxStop(function(){Tt()})},mt=function(){$(c).appendTo(O).show(),ht()},ht=function(){var n=$("<input>").attr("type","hidden").attr("name",L).val(vt);$(c).find(".form-submit").append($(n))},pt=function(){var n="["+l+"="+vt()+"]";$(_).hide(),$(_+n).addClass(v).show(),$(b).find(".children").find("li").show()},vt=function(){var n=$(p).attr(u);return n},bt=function(n,t){var i=n.offset();t.css({top:i.top,left:Wt()?i.left+n.outerWidth():i.left-t.outerWidth()})},gt=function(n){Y=n.outerWidth(),G=n.offset().left,J=G+Y},yt=function(n){return gt(n),J>X||0>G?!1:!0},wt=function(n){gt(n),Wt()&&J>X?(kt(J-X),At("in")):!Wt()&&0>G&&(kt(-G),At("in"))},kt=function(n){Q=n},Ct=function(){return Q},St=function(){$("html").click(function(n){0===$(n.target).parents(e).length&&xt(!0)})},Tt=function(){$(q).click(function(n){n.preventDefault(),xt(!0)})},xt=function(n){var t=$(w),i=$(O);$(c).appendTo(e).hide(),t.hasClass(x)&&(t.removeClass(x),n?(i.remove(),Et(h),At("out")):i.remove()),ft("hide"),$(b).removeClass(v)},At=function(n){var t=$(i.moveSiteSelector);t.css({position:"relative"}),It(t,n),i.moveSiteSelector!==a&&(Ot($(w),n),Ot($(O),n))},It=function(n,t){var o;if("in"===t?o=Ct():"out"===t&&(o="0"),i.animation===!1){var e={};e[i.position]=o,n.css(e)}else Ot(n,t)},Ot=function(n,t){var i,o=Wt()?"-":"";"in"===t?i=o+Ct():"out"===t&&(i="0"),Dt(n,i)},Dt=function(n,t){n.transition({x:t},400,i.animation)},Wt=function(){return"right"===i.position?!0:!1},jt=function(){var n=m,t=u;qt(n,t),Bt(n,t)},qt=function(n,t){$("["+n+"]").each(function(){var i=$(this),o=i.attr(n),e=$("["+t+'="'+o+'"]');e.length||i.parent().remove()})},zt={init:function(){this.permalinksHandler()},permalinksHandler:function(){$(c).on("click","a.incom-permalink",function(){var n=$(this.hash);if(n.length){Qt(n);var t=$(this).attr("href");return Lt(t),!1}})}},Bt=function(n,t){$("["+n+"]").click(function(){var i=$(this).attr(n),o=$("["+t+'="'+i+'"]');o.length&&(Qt(o),Et(E),o.addClass(E))})},Et=function(n){var t=$("."+n);0!==t.length&&(t.removeClass(n),0===t.prop("class").length&&t.removeAttr("class"))},Ft=function(){var n=$(B);if(n.length){n.css({display:"block",visibility:"visible"}),(n.css("opacity")<.2||Ht(n)<.2)&&n.css({color:"rgba(0,0,0,1)"}).fadeTo("fast",.5);var t=n.css("font-size").replace(/\D/g,"");6>t&&n.css({"font-size":"13px"});var i=n.css("color");/\s/g.test(i)&&(i=i.replace(/\s/g,"")),i=i.toLowerCase(),("rgb(255,255,255)"===i||"white"===i||"rgba(255,255,255,0)"===i)&&n.css("cssText","color: black!important;")}},Ht=function(n){var t=1,i=n.css("color");return/rgba/i.test(i)&&(t=i.replace(/^.*,(.+)\)/,"$1")),t},Nt=function(n){var t=parseInt(_t(n).substring(0,2),16),i=parseInt(_t(n).substring(2,4),16),o=parseInt(_t(n).substring(4,6),16);return t+","+i+","+o},_t=function(n){return"#"===n.charAt(0)?n.substring(1,7):n};$.easing.quart=function(n,t,i,o,e){return-o*((t=t/e-1)*t*t*t-1)+i};var Lt=function(n){history.pushState(null,null,n),history.pushState?history.pushState(null,null,n):location.hash=n},Qt=function(n){var t=$("html, body"),i=n.offset().top-30;t.animate({scrollTop:i},1200,"quart")}}(window.incom=window.incom||{},jQuery);