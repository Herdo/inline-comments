!function(t,$,n){var i,o="incom_wrapper",e="#"+o,a="html",r="comments-and-form",c="#"+r,s="incom-commentform",u="data-incom",l=u+"-comment",f=[],d=u+"-bubble",m=u+"-ref",p="incom-active",h="."+p,v="incom-visible-comment",b="."+v,g="incom-position-",y="incom-bubble",w="."+y,k=y+"-style",S=y+"-static",C="."+S,T=y+"-dynamic",x=y+"-active",A=y+"-link",I="incom-comments-wrapper",O="."+I,D="incom-reply",W="."+D,_="incom-cancel",j="."+_,q="incom-info-icon",z="."+q,B="incom-scrolled-to",E=c+" .comment",F="data_incom",H=0,N=$(window).width(),L,Q,X;t.init=function(t){Y(t),G(),J(),jt(),It(),$(W+" .comment-reply-link").on("click",function(){$(c+" #commentform").attr("id",s)}),Dt.init()},t.rebuild=function(){N=$(window).width(),f=[],$("#incom_wrapper .incom-bubble").remove(),J();var t=$(c+":visible");t.length&&(kt(),St("out"))};var Y=function(t){i=$.extend({selectors:"p",moveSiteSelector:a,countStatic:!0,alwaysStatic:!1,defaultBubbleText:"+",bubbleStyle:"bubble",bubbleAnimationIn:"default",bubbleAnimationOut:"default",position:"left",background:"white",backgroundOpacity:"1"},t)},G=function(){0===$(e).length&&$('<div id="'+o+'"></div>').appendTo($(a)).addClass(g+i.position)},J=function(){$(i.selectors).each(function(){K($(this)),M.createFromElement($(this))})},K=function(t,n){if(n=n||0,!t.attr(u)){var i=P(t);n=R(n,i);var o=i+n;t.attr(u,o)}},M={set:function(t){var i=$.extend({posX:n,posY:n,id:n,visible:!1},t)},createFromElement:function(t){U(t)}},P=function(t){var n=t.prop("tagName").substr(0,5);return n},R=function(t,n){var i=n+t;if(-1!==$.inArray(i,f))for(;-1!==$.inArray(i,f);)t++,i=n+t;return f.push(i),t},U=function(t){var n=V(t),i=tt(t),o=$("<a/>",{href:"","class":A}).text(n).wrap(i).parent().appendTo(e);ot(o),mt(t,o),ht(o)?(et(t,o),at(t,o)):o.hide()},V=function(t){var n;return n=it(t)?Z(t):i.defaultBubbleText},Z=function(t){var n=t.attr(u),i="["+l+"="+n+"]",o=$(i).length;return o+=$(i+" .children li").length},tt=function(t){var n=t.attr(u),i='<div class="'+nt(t)+'" '+d+'="'+n+'" />';return i},nt=function(t){var n=y,o=" ";return(i.alwaysStatic||it(t)&&i.countStatic)&&(n+=o+S),n+=it(t)||!it(t)&&"bubble"===i.bubbleStyle?o+k:o+T},it=function(t){var n=Z(t);return $.isNumeric(n)&&n>0?!0:!1},ot=function(t){t.hasClass(S)&&t.css("display","block")},et=function(t,n){n.hasClass(S)||t.add(n).hover(function(){$(w+":not("+C+")").hide(),"fadein"===i.bubbleAnimationIn?n.stop(!0,!0).fadeIn():n.stop(!0,!0).show(),ht(n)||n.hide()},function(){"fadeout"===i.bubbleAnimationOut?n.stop(!0,!0).fadeOut():n.stop(!0,!0).delay(700).hide(0)})},at=function(t,n){n.on("click",function(i){i.preventDefault(),$(this).hasClass(x)?(kt(!0),$(this).removeClass(x)):(_t(p),t.addClass(p),kt(),n.addClass(x),ct(n))})},rt=function(){var t;return t=0===$(O).length?$("<div/>",{"class":I}).appendTo(e).css("background-color","rgba("+zt(i.background)+","+i.backgroundOpacity+")"):$(O)},ct=function(t){var n=rt();ft(),ut(),mt(t,n),vt(n),yt(),st()},st=function(){$(document).ready(wt()).ajaxStop(function(){wt()})},ut=function(){$(c).appendTo(O).show(),lt()},lt=function(){var t=$("<input>").attr("type","hidden").attr("name",F).val(dt);$(c+" .form-submit").append($(t))},ft=function(){var t="["+l+"="+dt()+"]";$(E).hide(),$(E+t).addClass(v).show(),$(b+" .children li").show()},dt=function(){var t=$(h).attr(u);return t},mt=function(t,n){var i=t.offset();n.css({top:i.top,left:At()?i.left+t.outerWidth():i.left-n.outerWidth()})},pt=function(t){L=t.outerWidth(),Q=t.offset().left,X=Q+L},ht=function(t){return pt(t),X>N||0>Q?!1:!0},vt=function(t){pt(t),At()&&X>N?(bt(X-N),St("in")):!At()&&0>Q&&(bt(-Q),St("in"))},bt=function(t){H=t},gt=function(){return H},yt=function(){$("html").click(function(t){0===$(t.target).parents(e).length&&kt(!0)})},wt=function(){$(j).click(function(t){t.preventDefault(),kt(!0)})},kt=function(t){var n=$(w),i=$(O);$(c).appendTo(e).hide(),$(b).removeClass(v),n.hasClass(x)&&(n.removeClass(x),t?i.fadeOut("fast",function(){$(this).remove(),_t(p)}):i.remove(),St("out"))},St=function(t){var n=$(i.moveSiteSelector);n.css({position:"relative"}),Ct(n,t),i.moveSiteSelector!==a&&(xt(t,w),xt(t,O))},Ct=function(t,n){var i;"in"===n?i=gt():"out"===n&&(i="initial"),Tt(t,i)},Tt=function(t,n){var i=At()?"right":"left",o={};o[i]=n,t.css(o)},xt=function(t,n){var i=$(n);"in"===t?i.css({left:At()?"-="+gt():"+="+gt()}):"out"===t&&i.css({left:At()?"+="+gt():"-="+gt()})},At=function(){return"right"===i.position?!0:!1},It=function(){var t=m,n=u;Ot(t,n),Wt(t,n)},Ot=function(t,n){$("["+t+"]").each(function(){var i=$(this),o=i.attr(t),e=$("["+n+'="'+o+'"]');e.length||i.parent().remove()})},Dt={init:function(){this.permalinksHandler()},permalinksHandler:function(){$(c).on("click","a.incom-permalink",function(){var t=$(this.hash);if(t.length){Ft(t);var n=$(this).attr("href");return Et(n),!1}})}},Wt=function(t,n){$("["+t+"]").click(function(){var i=$(this).attr(t),o=$("["+n+'="'+i+'"]');o.length&&(Ft(o),_t(B),o.addClass(B))})},_t=function(t){var n=$("."+t);0!==n.length&&(n.removeClass(t),0===n.prop("class").length&&n.removeAttr("class"))},jt=function(){var t=$(z);if(t.length){t.attr("style","display:block!important;visibility:visible!important"),(t.css("opacity")<.2||qt(t)<.2)&&t.css({color:"rgba(0,0,0,1)"}).fadeTo("fast",.5);var n=t.css("font-size").replace(/\D/g,"");6>n&&t.css({"font-size":"13px"});var i=t.css("color");/\s/g.test(i)&&(i=i.replace(/\s/g,"")),i=i.toLowerCase(),("rgb(255,255,255)"===i||"white"===i||"rgba(255,255,255,0)"===i)&&t.css("cssText","color: black!important;")}},qt=function(t){var n=1,i=t.css("color");return/rgba/i.test(i)&&(n=i.replace(/^.*,(.+)\)/,"$1")),n},zt=function(t){var n=parseInt(Bt(t).substring(0,2),16),i=parseInt(Bt(t).substring(2,4),16),o=parseInt(Bt(t).substring(4,6),16);return n+","+i+","+o},Bt=function(t){return"#"===t.charAt(0)?t.substring(1,7):t};$.easing.quart=function(t,n,i,o,e){return-o*((n=n/e-1)*n*n*n-1)+i};var Et=function(t){history.pushState(null,null,t),history.pushState?history.pushState(null,null,t):location.hash=t},Ft=function(t){var n=$("html, body"),i=t.offset().top-30;n.animate({scrollTop:i},1200,"quart")}}(window.incom=window.incom||{},jQuery);